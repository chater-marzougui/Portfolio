const loadingScreen=document.getElementById("loading-screen"),welcomeScreen=document.getElementById("welcome-screen");function showWelcomeMessage(){const e=document.getElementById("welcome-message");welcomeScreen.style.display="flex";let t=0;const n="Welcome to My Portfolio   ";!function o(){const a=n.substring(0,t++);e.textContent=a,26===t&&setTimeout(()=>{e.style.display="none",welcomeScreen.style.display="none",document.body.style.overflow="auto"},700),setTimeout(o,60)}()}welcomeScreen.style.display="none",document.addEventListener("DOMContentLoaded",()=>{setTimeout(()=>{loadingScreen.style.display="none",showWelcomeMessage()},1e3)}),document.addEventListener("DOMContentLoaded",()=>{let e=0,t=0,n=!1;!function o(){const a=[" Web Developer "," Mobile Developer ",window.innerWidth<=768?" ICT Engineering<br>Student ":" ICT Engineering Student "," AI Enthusiast "],s=a[e],c=function(e){const t=e.trim().toLowerCase().charAt(0);return["a","e","i","o","u"].includes(t)}(s)?"n ":" ";let i="";if(s.includes("<br>")){const[e,o]=s.split("<br>");i=n?s.substring(0,t--):s.substring(0,t++),n||t!==e.length?n&&t===e.length+3&&(t-=3):t+=3}else i=n?s.substring(0,t--):s.substring(0,t++);const l=`<span style="color: aliceblue;">${c}</span><span style="color: var(--primary-color);">${i}</span>`;if(document.querySelector(".my-jobs").innerHTML=l,n||t!==s.length){if(n&&0===t)return n=!1,e=(e+1)%a.length,void setTimeout(o,500)}else setTimeout(()=>n=!0,2e3);setTimeout(o,n?50:100)}()});const navbar=document.querySelector(".navbar");function getRandomInt(e,t){return Math.floor(Math.random()*(t-e))+e}function getRandomFloat(e,t){return Math.random()*(t-e)+e}function getRandomAsteroidImage(){const e=["./assets/images/meteors/meteor1.png","./assets/images/meteors/meteor2.png","./assets/images/meteors/meteor3.png","./assets/images/meteors/meteor4.png","./assets/images/meteors/meteor5.png","./assets/images/meteors/meteor6.png"];return e[getRandomInt(0,e.length)]}function createAsteroid(){const e=document.createElement("div");e.classList.add("asteroid");const t=["small","medium","large"],n=t[getRandomInt(0,t.length)];e.classList.add(n);const o=["diagonal","steep","curved"];let a,s,c,i,l,r,d,m;switch(o[getRandomInt(0,o.length)]){case"diagonal":a=getRandomInt(-100,window.innerWidth+100),s=getRandomInt(-200,-50),c=a-window.innerWidth-200,i=s+300,d="diagonal-fall",m=getRandomFloat(1,3);break;case"steep":a=getRandomInt(.3*window.innerWidth,window.innerWidth+200),s=getRandomInt(-150,-50),c=a-.8*window.innerWidth,i=s+window.innerHeight-150,l=.6*(c-a),r=.4*(i-s),d="steep-fall",m=getRandomFloat(.5,2);break;case"curved":a=getRandomInt(.5*window.innerWidth,window.innerWidth+150),s=getRandomInt(-100,0),c=a-window.innerWidth,i=s+300,l=.3*(c-a)+getRandomInt(-100,100),r=.6*(i-s),d="curved-fall",m=getRandomFloat(1.5,3)}e.style.left="0px",e.style.top="0px",e.style.backgroundImage=`url('${getRandomAsteroidImage()}')`,e.style.setProperty("--start-x",`${a}px`),e.style.setProperty("--start-y",`${s}px`),e.style.setProperty("--end-x",`${c}px`),e.style.setProperty("--end-y",`${i}px`),void 0!==l&&void 0!==r&&(e.style.setProperty("--mid-x",`${l}px`),e.style.setProperty("--mid-y",`${r}px`)),e.style.animation=`${d} ${m}s ease-out forwards`,document.getElementById("asteroid-container").appendChild(e),e.addEventListener("animationend",()=>{e.parentNode&&e.remove()}),setTimeout(()=>{e.parentNode&&e.remove()},1e3*m+1e3)}function spawnAsteroids(){createAsteroid();const e=window.innerWidth<=768,t=getRandomInt(e?2e3:1500,e?5e3:4e3);setTimeout(spawnAsteroids,t)}function getStarProps(){const e=Math.random(),t=3*Math.random(),n=96*Math.random()+3,o=10*Math.random()+12,a=12*Math.random();let s=0;s=e<.4?Math.random()*document.body.scrollHeight*.1:Math.random()*document.body.scrollHeight*.45;return{startX:n,startY:s,size:t,duration:o,delay:a,endY:document.body.scrollHeight-s-10}}function generateStars(){const e=document.querySelector(".starry-sky");if(!e)return;const t=window.innerWidth<=768?Math.floor(120):200;for(let n=0;n<t;n++){let t=document.createElement("div");t.classList.add("star");const n=getStarProps();n.startY>n.endY&&(console.log("Inverted star detected:",n),console.log("Document body scroll height:",document.body.scrollHeight)),t.style.width=`${n.size}px`,t.style.height=`${n.size}px`,t.style.top=`${n.startY}px`,t.style.left=`${n.startX}%`,t.style.animationDuration=`${n.duration}s`,t.style.animationDelay=`${n.delay}s`,t.style.setProperty("--start-y",n.startY+"px"),t.style.setProperty("--end-y",n.endY+"px"),e.appendChild(t)}}async function populateSkills(e="./assets/json/skillset.json"){const t=await fetch(e);if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);const n=await t.json(),o=document.querySelector(".skills-container");if(!o)return;o.innerHTML="";const a=document.createElement("h2");a.textContent="Professional Skillset",o.appendChild(a);const s=document.createElement("ul");n.professionalSkillset.forEach(e=>{const t=document.createElement("li");let n;"fontawesome"===e.iconType?(n=document.createElement("i"),n.className=e.iconClass,n.style.fontFamily='"Font Awesome 6 Brands"',n.style.fontWeight="200"):(n=document.createElement("img"),n.className="icon",n.src=e.iconSrc,n.alt=e.iconAlt,e.style&&n.setAttribute("style",e.style));const o=document.createElement("h3");o.className="back",o.textContent=e.name,t.appendChild(n),t.appendChild(o),s.appendChild(t)}),o.appendChild(s);const c=document.createElement("h2");c.textContent="Tools",o.appendChild(c);const i=document.createElement("ul");n.tools.forEach(e=>{const t=document.createElement("li");let n;"fontawesome"===e.iconType?(n=document.createElement("i"),n.className=e.iconClass):(n=document.createElement("img"),n.className="icon",n.src=e.iconSrc,n.alt=e.iconAlt,e.style&&n.setAttribute("style",e.style));const o=document.createElement("h3");o.className="back",o.textContent=e.name,t.appendChild(n),t.appendChild(o),i.appendChild(t)}),o.appendChild(i)}function createProjectCard(e){const t=document.createElement("div");t.className="card",t.style.animationDelay=3*Math.random()+"s";const n=document.createElement("div");n.className="cover";const o=document.createElement("p");o.textContent=e.title,o.className="title",e.titleStyle&&(o.style.cssText=e.titleStyle);const a=document.createElement("span");a.className="job",a.textContent=e.technologies;const s=document.createElement("div");s.className="card-back";const c=document.createElement("h2");c.textContent="More Details:";const i=document.createElement("p");i.className="spbiography",i.textContent=e.description;const l=document.createElement("div");return l.className="project-links",e.linksStyle?l.style.cssText=e.linksStyle:l.style.cssText="height: 50px;",e.cardBackStyle&&(s.style.cssText=e.cardBackStyle),e.links.forEach(e=>{const t=document.createElement("a");t.href=e.url,t.target="_blank";const n=document.createElement("i");n.className=e.icon;const o=document.createElement("h3");o.textContent=e.label,t.appendChild(n),t.appendChild(o),l.appendChild(t)}),s.appendChild(c),s.appendChild(i),s.appendChild(l),n.appendChild(o),n.appendChild(a),n.appendChild(s),t.appendChild(n),t}async function loadProjects(e="./assets/json/projects.json"){try{const t=await fetch(e);if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);const n=await t.json(),o=document.getElementById("projects-list");if(!o)return;o.innerHTML="",n.projects.forEach(e=>{const t=createProjectCard(e);o.appendChild(t)})}catch(e){const t=document.getElementById("projects-list");t&&(t.innerHTML='\n                <div class="error-message">\n                    <p>Failed to load projects.</p>\n                </div>\n            ')}}async function loadContributions(){fetch("./assets/json/contributions.json").then(e=>e.json()).then(e=>{const t=e.data,n=t.totalContributions,o=t.weeks,a=document.createElement("h4");a.textContent=`Total Contributions this year: ${n}`,document.getElementById("legend").after(a);const s=document.getElementById("contribution-table");if(o&&o.length>0)for(let e=0;e<7;e++){const t=document.createElement("tr");for(let n=0;n<Math.min(o.length,53);n++){const a=o[n],s=a&&a.contributionDays?a.contributionDays[e]:null,c=s?s.contributionCount:0,i=document.createElement("td");let l;l=c<=6?Math.floor(c/2):4,i.className=`contrib-color-${l}`,n>20&&t.appendChild(i)}s.appendChild(t)}}).catch(()=>{const e=document.createElement("h4");e.textContent="Contributions data temporarily unavailable",document.getElementById("legend").after(e)})}async function loadSocials(){const e=document.getElementById("social-icons"),t=document.getElementById("social-icons-footer");try{const n=await fetch("./assets/json/socials.json"),o=await n.json(),a=document.createElement("div");a.className="whiteline",e.appendChild(a),o.socials.forEach(n=>{const o=document.createElement("a");if(n.faIcon){const e=document.createElement("i");e.className=n.faIcon,e.style.fontFamily='"Font Awesome 6 Brands"',o.appendChild(e)}else if(n.imgIcon){const e=document.createElement("img");e.src=n.imgIcon,e.alt=n.imgAlt,o.appendChild(e)}o.href=n.url,o.target="_blank",e.appendChild(o),t.appendChild(o.cloneNode(!0))}),e.appendChild(a.cloneNode(!0))}catch(e){}}function showToast(e,t,n=[]){const o=document.getElementById("toast-container");if(!o)return;const a=document.createElement("div");a.className=`toast toast-${t}`,a.innerHTML=`\n    <div>\n      <span class="toast-icon">${"success"===t?"✅":"❌"}</span>\n      <span>${e}</span>\n    </div>\n    <span class="toast-action">${n.length>0?"<h3> Try:</h3>"+n.map(e=>`<a href="${e.href}" target="_blank">${e.text}</a>`).join(""):""}</span>\n  `,o.appendChild(a);setTimeout(()=>a.remove(),"success"===t?2500:6e3)}function sendEmail(){if("undefined"==typeof Email)return void showToast("Email service is currently unavailable. Please try alternative contact methods.","error",[{href:"mailto:chater.mrezgui2002@gmail.com",text:"chater.mrezgui2002@gmail.com"},{href:"mailto:chater.marzougui@supcom.tn",text:"chater.marzougui@supcom.tn"}]);const e=document.getElementById("emailInput").value,t=document.getElementById("name").value,n=document.getElementById("subjectvalue").value,o=document.getElementById("message").value;Email.send({SecureToken:"c99ebf76-7044-4a97-a3a3-986ee50089d5",To:"chater.mrezgui2002@gmail.com",From:"chater.forarduinouse@gmail.com",Subject:t+" ["+n+"]",Body:"User Email: "+e+"<br><br>"+o}).then(e=>{"OK"===e?showToast("Email sent successfully!","success"):showToast("Failed to send email: "+e,"error",[{href:"mailto:chater.mrezgui2002@gmail.com",text:"Try chater.mrezgui2002@gmail.com"},{href:"mailto:chater.marzougui@supcom.tn",text:"Try chater.marzougui@supcom.tn"}])})}function sendVisitEmail(){if("undefined"==typeof Email)return;if(localStorage.getItem("visited"))return;const e=(new Date).toLocaleString();Email.send({SecureToken:"c99ebf76-7044-4a97-a3a3-986ee50089d5",To:"chater.mrezgui2002@gmail.com",From:"chater.forarduinouse@gmail.com",Subject:"New Visitor Alert - "+e,Body:`\n      <h2>🚀 Someone visited your site!</h2>\n      <p>Time: ${e}</p>\n      <p>This is an automated notification from your website.</p>\n    `}).then(e=>{"OK"===e&&localStorage.setItem("visited",!0)})}window.addEventListener("scroll",()=>{window.scrollY>0?navbar.classList.add("scrolled"):navbar.classList.remove("scrolled")}),window.addEventListener("scroll",function(){const e=document.querySelectorAll("section"),t=document.querySelectorAll(".barItems a");let n="c";e.forEach(e=>{const t=e.offsetTop,o=e.clientHeight,a=window.scrollY+50||window.pageY;a>=t&&a<t+o&&(n=e.id,window.scrollY<=0&&(n=""))}),t.forEach(e=>{e.classList.remove("active"),e.getAttribute("href").substring(1)===n&&e.classList.add("active")})}),spawnAsteroids(),setInterval(()=>{const e=window.innerWidth<=768,t=e?.1:.2,n=e?getRandomInt(2,4):getRandomInt(3,6);if(Math.random()<t)for(let e=0;e<n;e++)setTimeout(()=>createAsteroid(),200*e)},1e4),document.addEventListener("DOMContentLoaded",async()=>{await loadSocials(),await loadProjects(),await populateSkills(),await loadContributions(),generateStars()}),sendVisitEmail();